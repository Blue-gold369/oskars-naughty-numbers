<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Occasions Event Venue ROI Calculator — Fixed</title>
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji'; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1600px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 15px; box-shadow: 0 20px 60px rgba(0,0,0,.3); }
        h1 { color: #333; text-align: center; margin-bottom: 10px; font-size: 2.2rem; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
        .global-settings { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 25px; border-radius: 10px; margin-bottom: 30px; }
        .global-settings h2 { margin: 0; color: #fff; border-bottom: 2px solid rgba(255,255,255,.3); padding-bottom: 10px; }
        .settings-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap: 20px; margin-top: 20px; }
        .setting-item { background: rgba(255,255,255,.1); padding: 15px; border-radius: 8px; backdrop-filter: blur(10px); }
        .setting-item label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: .5px; }
        .setting-item input { width: 100%; padding: 10px; border: none; border-radius: 5px; font-size: 16px; font-weight: 700; text-align: center; background: #fff; color: #333; }
        .setting-item .help-text { font-size: 12px; margin-top: 5px; opacity: .9; }
        .scenarios-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px,1fr)); gap: 25px; margin-bottom: 30px; }
        .scenario-card { border: 2px solid #ddd; border-radius: 12px; overflow: hidden; background: #fff; box-shadow: 0 5px 15px rgba(0,0,0,.1); transition: transform .3s ease; }
        .scenario-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,.15); }
        .scenario-header { padding: 15px; font-weight: 800; font-size: 18px; text-align: center; color: #fff; }
        .scenario-header.minimum { background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); }
        .scenario-header.low { background: linear-gradient(135deg, #f2994a 0%, #f2c94c 100%); }
        .scenario-header.mid { background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%); }
        .scenario-header.high { background: linear-gradient(135deg, #3494e6 0%, #ec6ead 100%); }
        .scenario-body { padding: 20px; }
        .input-row { display: flex; justify-content: space-between; align-items: center; margin: 12px 0; padding: 10px; background: #f8f9fa; border-radius: 6px; }
        .input-row label { font-weight: 600; color: #555; }
        .input-row input { width: 140px; padding: 8px; border: 2px solid #ddd; border-radius: 5px; text-align: right; font-size: 16px; font-weight: 700; }
        .result-section { margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; }
        .result-section h4 { margin: 0 0 12px 0; color: #333; border-bottom: 2px solid #ddd; padding-bottom: 8px; font-size: 16px; }
        .result-row { display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: #fff; border-radius: 5px; }
        .result-row.total { background: #333; color: #fff; font-weight: 800; font-size: 16px; }
        .result-row.cost { background: #ffebee; color: #c62828; }
        .result-row.revenue { background: #e8f5e9; color: #2e7d32; }
        .roi-display { margin-top: 16px; padding: 16px; border-radius: 10px; text-align: center; }
        .roi-value { font-size: 32px; font-weight: 900; margin: 6px 0; }
        .roi-positive { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: #fff; }
        .roi-negative { background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); color: #fff; }
        .comparison-table { width: 100%; margin-top: 30px; border-collapse: collapse; border-radius: 10px; overflow: hidden; }
        .comparison-table th { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 12px; text-align: center; font-weight: 700; font-size: 14px; }
        .comparison-table td { padding: 10px; text-align: center; border-bottom: 1px solid #eee; font-variant-numeric: tabular-nums; }
        .comparison-table tr:hover { background: #f8f9fa; }
        .risk-dashboard { margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); border-radius: 12px; }
        .risk-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px,1fr)); gap: 20px; margin-top: 20px; }
        .risk-card { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,.1); }
        .risk-indicator { display: inline-block; padding: 8px 16px; border-radius: 20px; font-weight: 800; margin-top: 10px; }
        .risk-low { background: #4caf50; color: #fff; }
        .risk-medium { background: #ff9800; color: #fff; }
        .risk-high { background: #f44336; color: #fff; }
        .button-group { text-align: center; margin: 20px 0; }
        button { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; border: none; padding: 12px 30px; margin: 0 10px; border-radius: 25px; cursor: pointer; font-size: 16px; font-weight: 700; transition: transform .2s ease; }
        button:hover { transform: scale(1.05); }
        .metric { display: flex; justify-content: space-between; margin: 8px 0; padding: 8px; background: #f8f9fa; border-radius: 5px; }
        .metric-value { font-weight: 800; color: #667eea; }
        .small { font-size: 12px; opacity: .9; }
    </style>
</head>
<body>
<div class="container">
    <h1>Occasions Wedding Venue</h1>
    <p class="subtitle">ROI Calculator & Scenario Planner (fixed ROI, payback, and table columns)</p>

    <div class="global-settings">
        <h2>Global Settings</h2>
        <div class="settings-grid">
            <div class="setting-item">
                <label>Capital Investment</label>
                <input type="number" id="capitalCost" value="70000" onchange="recalculateAll()" />
                <div class="help-text">Initial project investment (CapEx)</div>
            </div>
            <div class="setting-item">
                <label>Interest Rate (%)</label>
                <input type="number" id="interestRate" value="10" onchange="recalculateAll()" />
                <div class="help-text">Annual financing cost on capital (interest-only)</div>
            </div>
            <div class="setting-item">
                <label>Project Life (years)</label>
                <input type="number" id="projectLife" value="10" onchange="recalculateAll()" />
                <div class="help-text">Used for lifetime simple ROI</div>
            </div>
            <div class="setting-item">
                <label>Customer PPH ($)</label>
                <input type="number" id="totalPPH" value="50" onchange="recalculateAll()" />
                <div class="help-text">Price charged per head</div>
            </div>
            <div class="setting-item">
                <label>Venue PPH ($)</label>
                <input type="number" id="olivewoodPPH" value="10" onchange="recalculateAll()" />
                <div class="help-text">Venue fee per head (cost)</div>
            </div>
            <div class="setting-item">
                <label>Operating Costs (annual)</label>
                <input type="number" id="operatingCosts" value="5000" onchange="recalculateAll()" />
                <div class="help-text">Annual operating expenses</div>
            </div>
            <div class="setting-item">
                <label>Misc Costs (annual)</label>
                <input type="number" id="miscCosts" value="17000" onchange="recalculateAll()" />
                <div class="help-text">Other annual expenses</div>
            </div>
        </div>
    </div>

    <div class="button-group">
        <button onclick="loadPresets()">Load Preset Scenarios</button>
        <button onclick="resetAll()">Reset All</button>
        <button onclick="printReport()">Print Report</button>
    </div>

    <div class="scenarios-grid" id="scenariosGrid"></div>

    <h2>Scenario Comparison</h2>
    <table class="comparison-table">
        <thead>
            <tr>
                <th>Scenario</th>
                <th>Events</th>
                <th>Total Guests</th>
                <th>Gross Revenue</th>
                <th>Venue Cost</th>
                <th>Net to Occasions</th>
                <th>Upsells</th>
                <th>Total Income</th>
                <th>Annual OpEx + Interest</th>
                <th>Annual Net Cash Flow</th>
                <th>Annual ROI on Capital</th>
            </tr>
        </thead>
        <tbody id="comparisonBody"></tbody>
    </table>

    <div class="risk-dashboard">
        <h2>Risk vs Reward Analysis</h2>
        <div class="risk-cards" id="riskCards"></div>
    </div>
</div>

<script>
const scenarios = [
    { id: 'minimum', name: 'MINIMUM', events: 5, guests: 100, upsell: 6000, color: 'minimum' },
    { id: 'low', name: 'LOW END', events: 8, guests: 125, upsell: 10000, color: 'low' },
    { id: 'mid', name: 'MID END', events: 12, guests: 125, upsell: 15000, color: 'mid' },
    { id: 'high', name: 'HIGH END', events: 16, guests: 125, upsell: 20000, color: 'high' }
];

function currency(n) { return `$${Number(n).toLocaleString()}`; }

function createScenarioCard(s) {
    return `
    <div class="scenario-card">
        <div class="scenario-header ${s.color}">${s.name}</div>
        <div class="scenario-body">
            <div class="input-row">
                <label>Number of Events:</label>
                <input type="number" id="${s.id}_events" value="${s.events}" onchange="calculateScenario('${s.id}')" />
            </div>
            <div class="input-row">
                <label>Guests per Event:</label>
                <input type="number" id="${s.id}_guests" value="${s.guests}" onchange="calculateScenario('${s.id}')" />
            </div>
            <div class="input-row">
                <label>Upsells ($ total/year):</label>
                <input type="number" id="${s.id}_upsell" value="${s.upsell}" onchange="calculateScenario('${s.id}')" />
            </div>

            <div class="result-section">
                <h4>Revenue Breakdown</h4>
                <div class="result-row"><span>Total Guests:</span><span id="${s.id}_totalGuests">0</span></div>
                <div class="result-row revenue"><span>Gross Revenue:</span><span id="${s.id}_grossRevenue">$0</span></div>
                <div class="result-row cost"><span>Venue Cost:</span><span id="${s.id}_venueCost">$0</span></div>
                <div class="result-row revenue"><span>Net to Occasions:</span><span id="${s.id}_netRevenue">$0</span></div>
                <div class="result-row revenue"><span>Upsell Income:</span><span id="${s.id}_upsellIncome">$0</span></div>
                <div class="result-row total"><span>Total Income (annual):</span><span id="${s.id}_totalIncome">$0</span></div>
            </div>

            <div class="result-section">
                <h4>Costs (annual + capital)</h4>
                <div class="result-row cost"><span>Capital Cost (one-off):</span><span id="${s.id}_capital">$0</span></div>
                <div class="result-row cost"><span>Interest (annual):</span><span id="${s.id}_interest">$0</span></div>
                <div class="result-row cost"><span>Operating Costs (annual):</span><span id="${s.id}_operating">$0</span></div>
                <div class="result-row cost"><span>Misc Costs (annual):</span><span id="${s.id}_misc">$0</span></div>
                <div class="result-row total"><span>Annual OpEx + Interest:</span><span id="${s.id}_annualRunRate">$0</span></div>
            </div>

            <div class="roi-display" id="${s.id}_roiDisplay">
                <div>Annual ROI on Capital</div>
                <div class="roi-value" id="${s.id}_roiValue">0%</div>
                <div id="${s.id}_profitLoss">Annual Net Cash Flow: $0</div>
                <div class="small" id="${s.id}_lifetimeRoi">Lifetime simple ROI (project life): 0%</div>
            </div>
        </div>
    </div>`;
}

function getGlobals() {
    const capitalCost = parseFloat(document.getElementById('capitalCost').value) || 0;
    const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
    const lifeYears = parseFloat(document.getElementById('projectLife').value) || 1;
    const totalPPH = parseFloat(document.getElementById('totalPPH').value) || 0;
    const venuePPH = parseFloat(document.getElementById('olivewoodPPH').value) || 0;
    const operatingCosts = parseFloat(document.getElementById('operatingCosts').value) || 0;
    const miscCosts = parseFloat(document.getElementById('miscCosts').value) || 0;
    return { capitalCost, interestRate, lifeYears, totalPPH, venuePPH, operatingCosts, miscCosts };
}

function calculateScenario(id) {
    const G = getGlobals();
    const events = parseFloat(document.getElementById(`${id}_events`).value) || 0;
    const guests = parseFloat(document.getElementById(`${id}_guests`).value) || 0;
    const upsell = parseFloat(document.getElementById(`${id}_upsell`).value) || 0;

    // Revenue
    const totalGuests = events * guests;
    const grossRevenue = totalGuests * G.totalPPH;
    const venueCost = totalGuests * G.venuePPH; // cost
    const netRevenue = grossRevenue - venueCost; // retained after venue cost
    const totalIncome = netRevenue + upsell; // annual income before OpEx/interest

    // Annual costs (run-rate) — do NOT add capital here
    const interestCost = G.capitalCost * (G.interestRate / 100);
    const annualRunRate = interestCost + G.operatingCosts + G.miscCosts;

    // Annual cash flow available to repay capital
    const annualNetCashFlow = totalIncome - annualRunRate; // this is the right numerator for ROI and payback

    // ROI definitions
    // Annual ROI on Capital = Annual Net Cash Flow / Capital
    const annualROI = (G.capitalCost > 0) ? (annualNetCashFlow / G.capitalCost) * 100 : 0;

    // Lifetime simple ROI = (Annual Net Cash Flow * life) / Capital
    const lifetimeSimpleROI = (G.capitalCost > 0) ? ((annualNetCashFlow * G.lifeYears) / G.capitalCost) * 100 : 0;

    // Update UI
    document.getElementById(`${id}_totalGuests`).textContent = totalGuests.toLocaleString();
    document.getElementById(`${id}_grossRevenue`).textContent = currency(grossRevenue);
    document.getElementById(`${id}_venueCost`).textContent = `-${currency(venueCost)}`;
    document.getElementById(`${id}_netRevenue`).textContent = currency(netRevenue);
    document.getElementById(`${id}_upsellIncome`).textContent = currency(upsell);
    document.getElementById(`${id}_totalIncome`).textContent = currency(totalIncome);

    document.getElementById(`${id}_capital`).textContent = currency(G.capitalCost);
    document.getElementById(`${id}_interest`).textContent = currency(interestCost);
    document.getElementById(`${id}_operating`).textContent = currency(G.operatingCosts);
    document.getElementById(`${id}_misc`).textContent = currency(G.miscCosts);
    document.getElementById(`${id}_annualRunRate`).textContent = currency(annualRunRate);

    const roiDisplay = document.getElementById(`${id}_roiDisplay`);
    roiDisplay.className = `roi-display ${annualNetCashFlow >= 0 ? 'roi-positive' : 'roi-negative'}`;
    document.getElementById(`${id}_roiValue`).textContent = `${annualROI.toFixed(2)}%`;
    document.getElementById(`${id}_profitLoss`).textContent = `Annual Net Cash Flow: ${currency(annualNetCashFlow)}`;
    document.getElementById(`${id}_lifetimeRoi`).textContent = `Lifetime simple ROI (project life): ${lifetimeSimpleROI.toFixed(0)}% over ${G.lifeYears} years`;

    updateComparisonTable();
    updateRiskAnalysis();
}

function updateComparisonTable() {
    const tbody = document.getElementById('comparisonBody');
    tbody.innerHTML = '';
    const G = getGlobals();

    scenarios.forEach(s => {
        const events = parseFloat(document.getElementById(`${s.id}_events`).value) || 0;
        const guests = parseFloat(document.getElementById(`${s.id}_guests`).value) || 0;
        const upsell = parseFloat(document.getElementById(`${s.id}_upsell`).value) || 0;

        const totalGuests = events * guests;
        const grossRevenue = totalGuests * G.totalPPH;
        const venueCost = totalGuests * G.venuePPH;
        const netRevenue = grossRevenue - venueCost;
        const totalIncome = netRevenue + upsell;

        const interestCost = G.capitalCost * (G.interestRate / 100);
        const annualRunRate = interestCost + G.operatingCosts + G.miscCosts;
        const annualNetCashFlow = totalIncome - annualRunRate;
        const annualROI = (G.capitalCost > 0) ? (annualNetCashFlow / G.capitalCost) * 100 : 0;

        const row = tbody.insertRow();
        row.innerHTML = `
            <td><strong>${s.name}</strong></td>
            <td>${events}</td>
            <td>${totalGuests.toLocaleString()}</td>
            <td>${grossRevenue.toLocaleString()}</td>
            <td style="color:#c62828;">-${venueCost.toLocaleString()}</td>
            <td style="color:#2e7d32;">${netRevenue.toLocaleString()}</td>
            <td>${upsell.toLocaleString()}</td>
            <td><strong>${totalIncome.toLocaleString()}</strong></td>
            <td>${(annualRunRate).toLocaleString()}</td>
            <td style="color:${annualNetCashFlow >= 0 ? '#2e7d32' : '#c62828'};">${annualNetCashFlow.toLocaleString()}</td>
            <td style="background:${annualROI >= 0 ? '#e8f5e9' : '#ffebee'}; color:${annualROI >= 0 ? '#2e7d32' : '#c62828'}; font-weight:700;">${annualROI.toFixed(2)}%</td>
        `;
    });
}

function updateRiskAnalysis() {
    const riskCards = document.getElementById('riskCards');
    riskCards.innerHTML = '';

    const G = getGlobals();
    const netPPH = G.totalPPH - G.venuePPH; // contribution per head to Occasions
    const interestCost = G.capitalCost * (G.interestRate / 100);
    const annualRunRate = interestCost + G.operatingCosts + G.miscCosts; // OpEx + financing only

    scenarios.forEach(s => {
        const events = parseFloat(document.getElementById(`${s.id}_events`).value) || 0;
        const guests = parseFloat(document.getElementById(`${s.id}_guests`).value) || 0;
        const upsell = parseFloat(document.getElementById(`${s.id}_upsell`).value) || 0;

        // Contribution per event (before OpEx + interest)
        const contributionPerEvent = (guests * netPPH) + (events > 0 ? (upsell / events) : 0);

        // Break-even events needed to cover annual run-rate (OpEx + interest)
        const breakEvenEvents = contributionPerEvent > 0 ? Math.ceil(annualRunRate / contributionPerEvent) : Infinity;
        const safetyMargin = isFinite(breakEvenEvents) ? (events - breakEvenEvents) : -Infinity;

        // Annual totals and payback
        const totalIncome = (events * guests * netPPH) + upsell;
        const annualNetCashFlow = totalIncome - annualRunRate;
        const paybackYears = annualNetCashFlow > 0 ? (G.capitalCost / annualNetCashFlow) : Infinity;

        let riskLevel = 'Medium Risk';
        let riskClass = 'risk-medium';
        if (!isFinite(paybackYears) || safetyMargin < 0 || paybackYears > 2) { riskLevel = 'High Risk'; riskClass = 'risk-high'; }
        else if (safetyMargin >= 3 && paybackYears <= 1) { riskLevel = 'Low Risk'; riskClass = 'risk-low'; }

        const card = document.createElement('div');
        card.className = 'risk-card';
        card.innerHTML = `
            <h3>${s.name}</h3>
            <div class="metric"><span>Payback Period:</span><span class="metric-value">${isFinite(paybackYears) ? paybackYears.toFixed(2) + ' years' : 'N/A'}</span></div>
            <div class="metric"><span>Break-even Events (per year):</span><span class="metric-value">${isFinite(breakEvenEvents) ? breakEvenEvents : 'N/A'}</span></div>
            <div class="metric"><span>Safety Margin:</span><span class="metric-value">${isFinite(safetyMargin) ? safetyMargin : 'N/A'} events</span></div>
            <div class="metric"><span>Contribution/Event:</span><span class="metric-value">${Math.round(contributionPerEvent).toLocaleString()}</span></div>
            <div class="metric"><span>Net PPH to Occasions:</span><span class="metric-value">${netPPH}</span></div>
            <div style="text-align:center;"><span class="risk-indicator ${riskClass}">${riskLevel}</span></div>
        `;
        riskCards.appendChild(card);
    });
}

function recalculateAll() { scenarios.forEach(s => calculateScenario(s.id)); }

function loadPresets() {
    const grid = document.getElementById('scenariosGrid');
    grid.innerHTML = '';
    scenarios.forEach(s => {
        const cardDiv = document.createElement('div');
        cardDiv.innerHTML = createScenarioCard(s);
        grid.appendChild(cardDiv.firstElementChild);
    });
    recalculateAll();
}

function resetAll() {
    document.getElementById('capitalCost').value = 70000;
    document.getElementById('interestRate').value = 10;
    document.getElementById('projectLife').value = 10;
    document.getElementById('totalPPH').value = 50;
    document.getElementById('olivewoodPPH').value = 10;
    document.getElementById('operatingCosts').value = 5000;
    document.getElementById('miscCosts').value = 17000;
    loadPresets();
}

function printReport() { window.print(); }

window.onload = loadPresets;
</script>
</body>
</html>
